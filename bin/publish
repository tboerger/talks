#!/bin/bash

safely() {
  if ! "$@"; then
    echo >&2 "Aborting due to failure of: $*"
    exit 1
  fi
}

safely git checkout gh-pages
safely git reset --hard master

for i in crowbar/revamped-cli docker/drone-intro
do
  safely sass --update ${i}/css/reveal-override.scss
  safely git add -f ${i}/css/*.css ${i}/css/*.map

  safely git commit -m "Latest .css and .css.map files within ${i} for publishing via gh-pages"
done

safely git push -f origin gh-pages
safely git checkout -
